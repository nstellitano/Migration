<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head lang="en">

    <title>Migration as an Instrument for International Development </title>
    <meta charset="UTF-8">

</head>

<!--Load Libraries-->
<script src="js/d3.min.js"></script>
<script src="js/topojson.v1.min.js"></script>
<script src="js/colorbrewer.js"></script>
<script src = "http://d3js.org/queue.v1.min.js"></script>
<script src="libs/jquery/jquery-2.1.1.min.js" charset="utf-8"></script>


<!-- add own vis classes-->
<script src = "js/map.js"></script>
<script src = "js/scatter.js"></script>
<script src = "js/OECDBAR.js"></script>
<script src = "js/stackbar.js"></script>
<script  src= "js/sankey.js"></script>
<script  src = "js/boe.js"></script>
<!--<script  src = "js/INFO.js"></script>-->


<!--Stylesheets-->
<link rel="stylesheet" type="text/css" href="libs/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/colorbrewer.css">
<!--<link rel="stylesheet" type = "text/css" href="css/960_12_col.css" />-->
<!--<link rel="stylesheet" type = "text/css" href="css/960_24_col.css" />-->
<!--&lt;!&ndash; Get some nice font&ndash;&gt;-->
<link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>

<!-- add own stylesheet-->
<link rel="stylesheet" type="text/css" href="css/myStyle.css">





<body>

<!--Setup the overall structure of the website-->
<div class = "container">
    <div id="header" class="header">
        <h1>Migration as an Instrument for International Development</h1>
            <div id="nav">
                <ul>
                    <li><a href="">Home</a></li>
                    <li><a href="">About</a></li>
                    <li><a href="">Video</a></li>
                    <li><a href="">Authors</a></li>
                </ul>
            </div>
    </div>




        <div  id = "dashboard" class="dashboard">
            <form>


                <label><input type="radio" name="layout" value="Wage" id = "Wage"  > Wage Comparison 2010 </label>
                <!--<label><input type="radio" name="layout" value="Remittance" id = "Remittance" > Remittance</label>-->
                <!--<label><input type="radio" name="layout" value="Aid" id = "Aid"> Aid</label>-->
                <label><input type="radio" name="layout" value="Migrant" id = "Migrant"> Migrant Flows 1980-2010</label>

            </form>

        </div>


    <div  id = "description" class="description">
        <p><b><u>Utilize for Story telling</u></b></p>
        <p>
            Displays Selected Countries

        </p>
    </div>

    <div  id = "world_map" class="world_map">
    </div>

    <div  id = "country_list" class="country_list">
        <p><b><u>Selected Countries</u></b></p>
        <p>
            Displays Selected Countries
        </p>
    </div>

    <div  id = "sankey_dash" class="sankey_dash">
        <p>
            1980: <input name="slider-time" value= 1980 id = "_1980" type="radio" checked>
            1985: <input name="slider-time" value= 1985 id = "_1985" type="radio" >
            1990: <input name="slider-time" value= 1990 id = "_1990" type="radio" >
            1995: <input name="slider-time" value= 1995 id = "_1995" type="radio" >
            2000: <input name="slider-time" value= 2000 id = "_2000" type="radio" >
            2005: <input name="slider-time" value= 2005 id = "_2005" type="radio" >
            2010: <input name="slider-time" value= 2010 id = "_2010" type="radio" >
            <!--<label>-->
                <!--<text id="year">Selected Year</text>-->
                <!--<input type="range" name="slider-time" min="1980" max="2010" step="5" value="0" id="slider-time" oninput=";">-->

            <!--</label>-->
        </p>
        <form>
            <b>
                By Education: <input name="sankey_type" value="sankey_ed" id = "sankey_ed" type="radio" checked>
                By OECD: <input name="sankey_type" value="sankey_oecd" id = "sankey_oecd" type="radio" >
            </b>
        </form>

    </div>

    <div  id = "sankey" class="sankey">

    </div>

    <div id="data_layout" class = "data_layout">
        <div  id = "graph_1" class="graph grid_8">

            <!--<p>Graph 1</p>-->
            <h3>Extra Annual Wage Earned</h3>
            <form>
                <b>
                   Compare: <input name="compare" value="compare" id = "compare" type="radio">
                    Don't Compare: <input name="compare" value="dcompare" id = "dcompare" type="radio" check>
                </b>
            </form>
            <b>Aggregated by:
            <form>
                <input name="oecd" value="migrant_stock" id = "migrant_stock" type="radio" checked>Migrant Stock
                <input name="oecd" value="per_capita" id = "per_capita" type="radio" checked >Per Capita
            </form></b>
        </div>

        <div  id = "stackbarVis" class="graph grid_8">

        </div>
        <p>
        <div  id = "scatterVis" class="graph grid_8">
            <b>Skill Level:</b>
            <input name="a" id = "low" value="lowskill" type="checkbox" checked>Low Skill
            <input name="a" id = "medium" value="medskill" type="checkbox" checked >Medium Skill
            <input name="a" id = "high" value="highskill" type="checkbox" checked >High Skill
        </div>
        </p>
        <div  id = "footers" class = "footers" >
            <p>Copyright etc...</p>
        </div>
    </div>
</div>




<script>
$(function() {


   // d3.select.("#country_list").write("test");
    //Create EventHandler
    var MyEventHandler = new Object()
    sank = new sankey_chart(d3.select("#sankey"))
    document.getElementById("sankey_dash").style.display = "none";
    document.getElementById("sankey").style.display = "none";

    var cdata, ccapitals, alldata;
    var last_name;
    var scatter_vis
    var stackbar_vis
    var oecd_bar, oecd_bar1, count=0;

    //------------Load the Data and begin-------------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------------------------------

    queue()
            .defer(d3.csv, "data/countries-data.csv")
            .defer(d3.json, "data/capitals.json")
            .defer(d3.json, "data/master_data_set.json")
            .defer(d3.json, "data/world-topo-110m.json")
            .defer(d3.json, "data/_1980.json")
            .defer(d3.json, "data/_1985.json")
            .defer(d3.json, "data/_1990.json")
            .defer(d3.json, "data/_1995.json")
            .defer(d3.json, "data/_2000.json")
            .defer(d3.json, "data/_2005.json")
            .defer(d3.json, "data/_2010.json")
            .await(ready)
    //Ready function takes the data files loaded via the queue function and begins with loading the WorldMap
    function ready(error, countries, capitals, AllData, topo, _1980, _1985, _1990, _1995, _2000, _2005, _2010) {
        cdata = countries;
        ccapitals = capitals
        alldata = AllData;



        //Make a WorldMap via the worldmap object
        world_map = new WorldMap(d3.select("#world_map"), cdata, ccapitals, alldata, MyEventHandler, topo, _1980, _1985, _1990, _1995, _2000, _2005, _2010);


//        world_map.heatmap(document.getElementById("Wage"));

        scatter_vis = new ScatterVis(d3.select("#scatterVis"), alldata, MyEventHandler);
        stackbar_vis = new StackbarVis(d3.select("#stackbarVis"), alldata, MyEventHandler);
        oecd_bar = new OECDBAR(d3.select("#graph_1"), alldata, MyEventHandler)
//        desc_info = new Info(d3.select("description",alldata, MyEventHandler))



    //------------Events-------------------------------------------------------------------------------------------------------------------------------
    //-------------------------------------------------------------------------------------------------------------------------------------------------

    $(MyEventHandler).bind("map_selection", function (event, name) { //input name is 1 country in array format

        last_name = [name];
        //world_map.draw_arcData(last_name)
        oecd_bar.wrangledata([name])
        //stack
        //scatter
        changeDivHTML(last_name);

    });

        $(MyEventHandler).bind("oecd_selection", function (event, name) { //input name is 1 country in array format

//            world_map.draw_arcData(last_name)

            //stackbar_vis.wrangleData(country_select);
//            oecd_bar.wrangledata([name])
//            //stack
//            //scatter
            //changeDivHTML(name);

    });

        $(MyEventHandler).bind("scatter_selection", function (event, name, name1, name2, name3, name4, name5, name6, name7, name8, name9, name10, name11, name12, name13, name14, name15, name16, name17, name18, name19) {//input name will be an array of names -> singular array or multiple array
                country_select = [name, name1, name2, name3, name4, name5, name6, name7, name8, name9, name10, name11, name12, name13, name14, name15, name16, name17, name18, name19];
//            world_map.draw_arcData(last_name)


            for(i=19; i>-1; i--){
                if((country_select[i]===undefined)){
                    country_select.splice(i,1)
                }
            }


            stackbar_vis.wrangleData(country_select);
            oecd_bar.wrangledata(country_select)
//
            changeDivHTML(country_select);


        });

        $(MyEventHandler).bind("nonoecd_selection", function (event, name) {//{input name is 1 country in array format

//            world_map.draw_arcData(last_name)
            console.log(name)
            oecd_bar.wrangledata(name)
//            //stack
//            //scatter
            //changeDivHTML(name);

        });
    d3.selectAll("input").on("change", function()
    {

        if(d3.select(this).attr("name")  == "oecd" || d3.select(this).attr("name")  == "compare"){

            oecd_bar.wrangledata(last_name)
        }

        if(d3.select(this).attr("name")  == "layout" && d3.select(this).attr("id")  == "Migrant"){



            document.getElementById("sankey_dash").style.display = "";
            document.getElementById("sankey").style.display = "";

            document.getElementById("data_layout").style.display = "none";
            document.getElementById("country_list").style.display = "none";

            world_map.heatmap()




        }

        if(d3.select(this).attr("name")  == "layout" && d3.select(this).attr("id")  == "Wage") {


            world_map.heatmap();

            document.getElementById("sankey_dash").style.display = "none";
            document.getElementById("sankey").style.display = "none";

            document.getElementById("data_layout").style.display = "";
            document.getElementById("country_list").style.display = "";


        }

                if (d3.select(this).attr("name") == "slider-time") {

                    sank.update();

                    world_map.heatmap()
                }

        if (d3.select(this).attr("name") == "sankey_type") {

            sank.update();

            world_map.heatmap()
        }


    });


    function changeDivHTML(name)
    {

        //clear current list
        document.getElementById('country_list').innerHTML = ("<p><b><u>Selected Countries</u></b></p>");

        var previousInnerHTML = new String();

        previousInnerHTML = document.getElementById('country_list').innerHTML;

        for(i=0; i<name.length; i++)
        {
            if(i!=name.length-1) {
                previousInnerHTML = previousInnerHTML.concat("<h5>" + name[i] + "," + "<h5>")
            }else
            {
                previousInnerHTML = previousInnerHTML.concat("<h5>" + name[i] + "<h5>")
            }
        }
//        if(d3.select(radio).attr("value") == "NONOECD") {
//
//            for (i = 0; i < 195; i++) {
//                var check = true;
//                for (z = 0; z < 20; z++) {
//                    if (alldata._children[1]._children[i].name == alldata._children[z].name){ check=false}
//
//                }
//                if (check==true) { previousInnerHTML = previousInnerHTML.concat("<h5>" + alldata._children[1]._children[i].name + "<h5>");}
//            }
//        }
//
//        if(d3.select(radio).attr("value") == "OECD") {
//
//            for (i = 0; i < 20; i++) {
//                previousInnerHTML = previousInnerHTML.concat("<h5>" + alldata._children[i].name + "<h5>");
//            }
//
//        }
//
//        if(d3.select(radio).attr("value") == "Migrant" || d3.select(radio).attr("value") == "Remittance" || d3.select(radio).attr("value") == "Aid") {
//
//            for (i = 0; i < 195; i++) {
//                previousInnerHTML = previousInnerHTML.concat("<h5>" + alldata._children[1]._children[i].name + "<h5>");
//            }
//
//        }

        document.getElementById('country_list').innerHTML = previousInnerHTML;

    }



    };


})
</script>

</body>
</html>
